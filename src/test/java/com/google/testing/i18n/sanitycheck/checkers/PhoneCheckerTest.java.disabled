package com.google.testing.i18n.sanitycheck.checkers;

import com.google.testing.i18n.sanitycheck.parser.Placeholder;

import com.ibm.icu.util.ULocale;

import junit.framework.TestCase;

import org.junit.Assert;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.junit.runners.JUnit4;

/** Tests the {@link PhoneNumberChecker} class functionality. */
@RunWith(JUnit4.class)
public class PhoneCheckerTest extends TestCase {

  private final PhoneNumberChecker checker = new PhoneNumberChecker();

  @Test
  public void testCheck_Lenient() {
    Placeholder testToken = Placeholder.builder("phone", "+1 650 224 2244").build();
    checker.check(testToken, ULocale.US, null);
  }

  @Test
  public void testCheck_NotLenient() {
    Placeholder testToken =
        Placeholder.builder("phone", "6502242244").putLenientParam(false).build();
    checker.check(testToken, ULocale.US, null);
  }

  @Test
  public void testCheck_Strict() {
    Placeholder testToken = Placeholder.builder("phone", "+1-650-224-2244").putLenientParam(false)
        .putStrictParam(true).build();
    checker.check(testToken, ULocale.US, null);
  }

  @Test
  public void testCheck_LenientFail() {
    boolean failed = false;
    try {
      Placeholder testToken = Placeholder.builder("phone", "321 567").build();
      checker.check(testToken, ULocale.US, null);
    } catch (AssertionError e) {
      failed = true;
    }
    Assert.assertTrue("Should fail on this case.", failed);
  }

  @Test
  public void testCheck_NotLenientFail() {
    boolean failed = false;
    try {
      Placeholder testToken =
          Placeholder.builder("phone", "+1345-650-224-2244").putLenientParam(false).build();
      checker.check(testToken, ULocale.US, null);
    } catch (AssertionError e) {
      failed = true;
    }
    Assert.assertTrue("Should fail on this case.", failed);
  }

  @Test
  public void testCheck_StrictFail() {
    boolean failed = false;
    try {
      Placeholder testToken = Placeholder.builder("phone", "+8-650-224-2244").putLenientParam(false)
          .putStrictParam(true).build();
      checker.check(testToken, ULocale.US, null);
    } catch (AssertionError e) {
      failed = true;
    }
    Assert.assertTrue("Should fail on this case.", failed);
  }
}
